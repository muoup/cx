#include <stdio.h>

struct strong_ptr_container {
    int other_data;
    int strong* ptr;
};

~strong_ptr_container(this) {
    printf("~strong_ptr_container\n");
}

int main() {
    int strong* ptr = new int;
    int strong[] ptr2 = new int[2];
    int strong* ptr_moved = move ptr;

    strong_ptr_container container;
    container.ptr = new int;

    strong_ptr_container strong* container_ptr = new strong_ptr_container;
    strong_ptr_container strong[] container_array = new strong_ptr_container[2];
    
    // Clean up in reverse order of creation
    // 1. container_array: stdfree array with deconstruction
    //    __stdfreearray length = 2
    //    __stdfreearray: calling destructor for element 0
    //    ~strong_ptr_container
    //    __stdfreearray: calling destructor for element 1
    //    ~strong_ptr_container
    // 2. container_ptr: stdfree with destructor
    //    ~strong_ptr_container
    //    __stdfree
    // 3. container: stdfree for inner + deconstruction
    //    __stdfree
    //    ~strong_ptr_container
    // 4. ptr_moved: stdfree
    //    __stdfree
    // 5. ptr2: stdfree array with noop deconstruction
    //    __stdfreearray_destructor_noop
    // 6. ptr: N/A (moved so cleanup will early exit)
}